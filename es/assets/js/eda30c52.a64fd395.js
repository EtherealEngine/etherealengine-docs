"use strict";(self.webpackChunk_etherealengine_docs=self.webpackChunk_etherealengine_docs||[]).push([[98],{5673:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var s=t(4848),o=t(8453);const i={sidebar_label:"ECS"},r="Entities, Components and Systems",a={id:"manual/modules/engine/ecs",title:"Entities, Components and Systems",description:"What is an ECS?",source:"@site/docs/manual/03_modules/01_engine/04_ecs.md",sourceDirName:"manual/03_modules/01_engine",slug:"/manual/modules/engine/ecs",permalink:"/etherealengine-docs/es/manual/modules/engine/ecs",draft:!1,unlisted:!1,editUrl:"https://github.com/EtherealEngine/etherealengine-docs/blob/master/docs/manual/03_modules/01_engine/04_ecs.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_label:"ECS"},sidebar:"manual",previous:{title:"Engine",permalink:"/etherealengine-docs/es/manual/modules/engine/"},next:{title:"Networking",permalink:"/etherealengine-docs/es/manual/modules/engine/networking"}},c={},l=[{value:"What is an ECS?",id:"what-is-an-ecs",level:2},{value:"Component Data Types",id:"component-data-types",level:2},{value:"Structure of Arrays: Component Data",id:"structure-of-arrays-component-data",level:3},{value:"Array of Structures: Reactive Component Data",id:"array-of-structures-reactive-component-data",level:3},{value:"Examples",id:"examples",level:2},{value:"Timer",id:"timer",level:3},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"entities-components-and-systems",children:"Entities, Components and Systems"}),"\n",(0,s.jsx)(n.h2,{id:"what-is-an-ecs",children:"What is an ECS?"}),"\n",(0,s.jsxs)(n.p,{children:['ECS refers to the "',(0,s.jsx)(n.strong,{children:"Entity Component System"}),'" architecture paradigm, that is characterized by these three key elements:']}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Entities"})," are simply collections of components identified by a number."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Components"})," are abstract objects that contain data.",(0,s.jsx)(n.br,{}),"\n","They allow data to be structured with composition instead of inheritance."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Systems"})," are functions that operate on these entities and components."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"component-data-types",children:"Component Data Types"}),"\n",(0,s.jsx)(n.p,{children:"Components support two types of data:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Structure of Arrays"}),"\n",(0,s.jsx)(n.li,{children:"Array of Structures"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"structure-of-arrays-component-data",children:"Structure of Arrays: Component Data"}),"\n",(0,s.jsxs)(n.p,{children:["Structure of Arrays is a data layout that stores data in a way that is more cache friendly.",(0,s.jsx)(n.br,{}),"\n","It is a good choice for data that is accessed often and in a predictable way, such as transform data."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const TransformComponent = defineComponent({\n  name: 'TransformComponent',\n  schema: {\n    position: Types.f64,\n    rotation: Types.f64,\n    scale: Types.f64\n  }\n})\n"})}),"\n",(0,s.jsx)(n.h3,{id:"array-of-structures-reactive-component-data",children:"Array of Structures: Reactive Component Data"}),"\n",(0,s.jsxs)(n.p,{children:["Reactive Component Data is an implementation unique to iR Engine, using ",(0,s.jsx)(n.code,{children:"React"})," and ",(0,s.jsx)(n.code,{children:"Hookstate"})," under the hood."]}),"\n",(0,s.jsx)(n.p,{children:"Its key benefits are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["It allows for reactive data binding.",(0,s.jsx)(n.br,{}),"\n","When a property is changed, all effects depending on that data will be triggered."]}),"\n",(0,s.jsxs)(n.li,{children:["It is a good choice for data that is accessed infrequently and in an unpredictable way.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.em,{children:"(especially when react style logic is associated with it)"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const DebugArrowComponent = defineComponent({\n  name: 'DebugArrowComponent',\n\n  onInit: (entity) => {\n    return {\n      color: 0xffffff,\n      direction: new Vector3(),\n      position: new Vector3()\n    }\n  },\n\n  onSet: (entity, component, json) => {\n    if (!json) return\n\n    if (json.color) component.color.set(json.color)\n    if (json.direction) component.direction.set(json.direction)\n    if (json.position) component.position.set(json.position)\n  }\n})\n"})}),"\n",(0,s.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(n.h3,{id:"timer",children:"Timer"}),"\n",(0,s.jsxs)(n.p,{children:["In the following code snippets we will define a ",(0,s.jsx)(n.code,{children:"component"})," and a ",(0,s.jsx)(n.code,{children:"system"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"TimerComponent"})," will hold a property to store the current elapsed time rounded down.",(0,s.jsx)(n.br,{}),"\n","In the ",(0,s.jsx)(n.strong,{children:"initializer"})," of the system, we will create a new entity and adds the time component to it.",(0,s.jsx)(n.br,{}),"\n","In the ",(0,s.jsx)(n.strong,{children:"execute"})," function of the system, we will set the property ",(0,s.jsx)(n.code,{children:"time"})," on the component of the entity."]}),"\n",(0,s.jsxs)(n.p,{children:["This example uses the ",(0,s.jsx)(n.em,{children:(0,s.jsx)(n.code,{children:"Structure of Arrays"})})," (SoA) Component Data syntax, from ",(0,s.jsx)(n.strong,{children:"bitECS"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const TimerComponent = defineComponent({\n  name: 'TimerComponent',\n  schema: {\n    time: Types.f32\n  }\n})\n\nconst timerQuery = defineQuery([TimerComponent])\n\nconst execute = () => {\n  const { deltaSeconds } = getState(EngineState)\n\n  for (const entity of timerQuery()) {\n      TimerComponent.time[entity] += delta\n  }\n}\n\nexport const TimerSystem = defineSystem({\n  uuid: 'TimerSystem',\n  execute\n})\n\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This example uses the ",(0,s.jsx)(n.em,{children:(0,s.jsx)(n.code,{children:"Array of Structures"})})," Reactive Component Data syntax, from iR Engine, which allows for reactive data binding."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const TimerComponent = defineComponent({\n  name: 'TimerComponent',\n  onInit: (entity) => {\n    return {\n      time: 0\n    }\n  },\n  onSet: (entity, component, json) => {\n    if (typeof json?.time === 'number') component.time.set(json.time)\n  },\n  toJSON: (entity, component) => {\n    return {\n      time: component.time.value\n    }\n  }\n})\n\nconst timerQuery = defineQuery([TimerComponent])\n\nconst execute = () => {\n  const { elapsedSeconds } = getState(EngineState)\n\n  for (const entity of timerQuery()) {\n    const timerComponent = getMutableComponent(entity, TimerComponent)\n    timerComponent.time.set(Math.floor(elapsedSeconds))\n  }\n}\n\nexport const TimerSystem = defineSystem({\n  uuid: 'TimerSystem',\n  execute\n})\n"})}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=2rW7ALyHaas",children:"Entity Component System Overview in 7 Minutes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=BVIiAO5-2-Y",children:"Entity Component System in TypeScript with Phaser 3 and bitECS)"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=W3aieHjyNvw",children:"Overwatch GDC ECS & Netcode"})," (note, iR Engine does not use this style of networking)"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(6540);const o={},i=s.createContext(o);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);