"use strict";(self.webpackChunk_etherealengine_docs=self.webpackChunk_etherealengine_docs||[]).push([[9162],{211:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var n=o(4848),i=o(8453);const r={},s="Route 53",a={id:"manual/modules/infrastructure/devopsDeployment/AWSSetup/route53",title:"Route 53",description:"Create Route 53 Hosted Zone and set up ACM certificates",source:"@site/docs/manual/03_modules/05_infrastructure/03_devopsDeployment/03_AWSSetup/07_route53.md",sourceDirName:"manual/03_modules/05_infrastructure/03_devopsDeployment/03_AWSSetup",slug:"/manual/modules/infrastructure/devopsDeployment/AWSSetup/route53",permalink:"/etherealengine-docs/manual/modules/infrastructure/devopsDeployment/AWSSetup/route53",draft:!1,unlisted:!1,editUrl:"https://github.com/EtherealEngine/etherealengine-docs/blob/master/docs/manual/03_modules/05_infrastructure/03_devopsDeployment/03_AWSSetup/07_route53.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{},sidebar:"manual",previous:{title:"Security Group",permalink:"/etherealengine-docs/manual/modules/infrastructure/devopsDeployment/AWSSetup/securityGroup"},next:{title:"Agones, ingress-nginx and Redis",permalink:"/etherealengine-docs/manual/modules/infrastructure/devopsDeployment/AWSSetup/agonesNginxRedis"}},d={},l=[{value:"Create Route 53 Hosted Zone and set up ACM certificates",id:"create-route-53-hosted-zone-and-set-up-acm-certificates",level:2},{value:"Purchase and register domain through Route53 (optional)",id:"purchase-and-register-domain-through-route53-optional",level:3},{value:"Create Route 53 Hosted Zone",id:"create-route-53-hosted-zone",level:3},{value:"Point external registrar subdomains to use Route53 Nameservers (only if your domain is registered outside Route53)",id:"point-external-registrar-subdomains-to-use-route53-nameservers-only-if-your-domain-is-registered-outside-route53",level:4},{value:"Create certificates with ACM",id:"create-certificates-with-acm",level:3},{value:"If you are serving client files from client or API pods",id:"if-you-are-serving-client-files-from-client-or-api-pods",level:4},{value:"If you are serving client files from the Storage Provider",id:"if-you-are-serving-client-files-from-the-storage-provider",level:4}];function u(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"route-53",children:"Route 53"}),"\n",(0,n.jsx)(t.h2,{id:"create-route-53-hosted-zone-and-set-up-acm-certificates",children:"Create Route 53 Hosted Zone and set up ACM certificates"}),"\n",(0,n.jsx)(t.p,{children:"Before installing Nginx to the cluster, you'll need to have all of the networking squared away.\nThis requires creating the necessary SSL certificates and creating some DNS records to point\nvarious subdomains to the right place."}),"\n",(0,n.jsx)(t.h3,{id:"purchase-and-register-domain-through-route53-optional",children:"Purchase and register domain through Route53 (optional)"}),"\n",(0,n.jsx)(t.p,{children:"If you do not have a domain for your application already, it's easiest to register it through Route53.\nGo to Route53->Domains->Registered domains, then click the 'Register Domain' button, and follow the\nworkflow to register a domain name."}),"\n",(0,n.jsx)(t.h3,{id:"create-route-53-hosted-zone",children:"Create Route 53 Hosted Zone"}),"\n",(0,n.jsx)(t.p,{children:"In the AWS web client, go to Route 53. Make a hosted zone for the domain you plan to use for\nyour setup of iR Engine. You'll be coming back here later to create DNS records."}),"\n",(0,n.jsx)(t.p,{children:"Open the Hosted zone, then click on 'Hosted zone details' to see more information. The value 'Hosted zone id'\nis used in the dev/prod.values.yaml file for 'ROUTE53_HOSTED_ZONE_ID'"}),"\n",(0,n.jsx)(t.h4,{id:"point-external-registrar-subdomains-to-use-route53-nameservers-only-if-your-domain-is-registered-outside-route53",children:"Point external registrar subdomains to use Route53 Nameservers (only if your domain is registered outside Route53)"}),"\n",(0,n.jsx)(t.p,{children:"If you already have a domain registered with another registrar service, you'll need to add some DNS records\nin there to point the specific subdomains you'll be using to AWS' nameservers."}),"\n",(0,n.jsx)(t.p,{children:"First, go to Route53->Hosted Zones and open the domain you'll be using by clicking on the domain name (or\nhighlighting the row and clicking the 'View details' button). There should be two records under Records.\nLook for the one of type 'NS'; under 'Value/Route traffic to', there should be four lines that all start\nwith 'ns-'. These will be used shortly."}),"\n",(0,n.jsx)(t.p,{children:"Go to your external registrar and go to the DNS records page. For each subdomain that will be in use, you\nneed to add four records of type 'NS'. The Name wil be the subdomain, and the Nameserver will be one of\nthe four lines under the 'NS'. You need a record for each of the four lines."}),"\n",(0,n.jsx)(t.p,{children:"If you're setting up multiple deployments, e.g. both a dev and prod deployment, you'll need a set of four\nNS records for each subdomain that those deployments will be behind."}),"\n",(0,n.jsx)(t.h3,{id:"create-certificates-with-acm",children:"Create certificates with ACM"}),"\n",(0,n.jsx)(t.p,{children:"Go to Amazon Certificate Manager. If there are no certs in that region, click on Get Started under Provision Certificates,\notherwise click on Request a Certificate."}),"\n",(0,n.jsxs)(t.p,{children:["You should select Request a Public Certificate, then select Request a Certificate. The next page\nshould be headed Add Domain Names. You should add both the top-level domain, such as ",(0,n.jsx)(t.code,{children:"etherealengine.org"}),",\nas well as a wildcard for all subdomains e.g. ",(0,n.jsx)(t.code,{children:"*.etherealengine.org"}),", then click Next."]}),"\n",(0,n.jsx)(t.p,{children:"Choose DNS Validation on the next page and click Next. You can skip adding tags and just click Review,\nthen Confirm on the final page."}),"\n",(0,n.jsx)(t.p,{children:"You should be sent to a page headed Validation. Click on the arrow next to each domain to open more\noptions. Click on the button Create Record in Route 53 to open a confirmation modal, and in that modal\nclick Create."}),"\n",(0,n.jsx)(t.p,{children:"As it indicates, it can take up to 30 minutes for these domains to be validated. If you click on Complete\nafter triggering the record creation for each of them, you should be sent back to the Certificates page.\nOpening the cert you just made will show the validation status of each domain."}),"\n",(0,n.jsxs)(t.p,{children:["If you open the details of this certificate, there should be a field 'ARN' with a value that looks\nsomething like ",(0,n.jsx)(t.code,{children:"arn:aws:acm:<region>:<AWS account ID>:certificate/<a UUID>"}),". Take note of this for later,\nwhen you go to install ingress-nginx."]}),"\n",(0,n.jsx)(t.h4,{id:"if-you-are-serving-client-files-from-client-or-api-pods",children:"If you are serving client files from client or API pods"}),"\n",(0,n.jsxs)(t.p,{children:["You should follow the above instructions to make a second certificate for ",(0,n.jsx)(t.code,{children:"resources.<domain>"}),".\nNote that this certificate MUST be made in us-east-1, regardless of which region everything else is\nset up in; as of this writing, CloudFront can only use certificates in us-east-1."]}),"\n",(0,n.jsx)(t.h4,{id:"if-you-are-serving-client-files-from-the-storage-provider",children:"If you are serving client files from the Storage Provider"}),"\n",(0,n.jsxs)(t.p,{children:["You should follow the above instructions to make a second certificate for ",(0,n.jsx)(t.code,{children:"<RELEASE_NAME>.<domain>"}),".\nNote that this certificate MUST be made in us-east-1, regardless of which region everything else is\nset up in; as of this writing, CloudFront can only use certificates in us-east-1."]})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},8453:(e,t,o)=>{o.d(t,{R:()=>s,x:()=>a});var n=o(6540);const i={},r=n.createContext(i);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);