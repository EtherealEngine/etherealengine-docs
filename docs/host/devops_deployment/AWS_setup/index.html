<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-host/devops_deployment/AWS_setup">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Ethereal Engine on AWS | etherealengine</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://etherealengine.github.io/etherealengine-docs/docs/host/devops_deployment/AWS_setup"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ethereal Engine on AWS | etherealengine"><meta data-rh="true" name="description" content="The value RELEASE_NAME referenced throughout this guide is the name of the deployment, e.g. dev or prod."><meta data-rh="true" property="og:description" content="The value RELEASE_NAME referenced throughout this guide is the name of the deployment, e.g. dev or prod."><link data-rh="true" rel="icon" href="/etherealengine-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://etherealengine.github.io/etherealengine-docs/docs/host/devops_deployment/AWS_setup"><link data-rh="true" rel="alternate" href="https://etherealengine.github.io/etherealengine-docs/docs/host/devops_deployment/AWS_setup" hreflang="en"><link data-rh="true" rel="alternate" href="https://etherealengine.github.io/etherealengine-docs/es/docs/host/devops_deployment/AWS_setup" hreflang="es"><link data-rh="true" rel="alternate" href="https://etherealengine.github.io/etherealengine-docs/docs/host/devops_deployment/AWS_setup" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://N5OIDFHT9B-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="etherealengine" href="/etherealengine-docs/opensearch.xml"><link rel="stylesheet" href="/etherealengine-docs/assets/css/styles.6c1ddb1d.css">
<link rel="preload" href="/etherealengine-docs/assets/js/runtime~main.6c67445e.js" as="script">
<link rel="preload" href="/etherealengine-docs/assets/js/main.a156226e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/etherealengine-docs/"><div class="navbar__logo"><img src="/etherealengine-docs/img/logo.svg" alt="Ethereal Engine Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/etherealengine-docs/img/logo.svg" alt="Ethereal Engine Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Ethereal Engine</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/etherealengine-docs/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://etherealengine.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Ethereal Engine<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/etherealengine-docs/docs/host/devops_deployment/AWS_setup" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/etherealengine-docs/es/docs/host/devops_deployment/AWS_setup" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Espa√±ol</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/etherealengine-docs/docs/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/etherealengine-docs/docs/host/">Ethereal for Hosts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ethereal for Hosts&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/etherealengine-docs/docs/host/installation/">Installation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/">Deployment</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deployment&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/microk8s_linux">Ethereal Engine on MicroK8s (Linux)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/microk8s_windows">Ethereal Engine on MicroK8s (Windows)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/docker_desktop">Ethereal Engine on Docker Desktop</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/minikube">Ethereal Engine on Minikube</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/AWS_setup">Ethereal Engine on AWS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/installing_projects">Installing Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/database_migrations">Database Migrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/setup_github_oauth_for_projects">How to set up GitHub to install external projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/managing_remote_kubernetes">Cluster Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/release_helm_chart">Release Helm Chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/upgrade_helm_deployment">Upgrading Helm Release</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/etherealengine-docs/docs/host/devops_deployment/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/etherealengine-docs/docs/host/Admin_Dashboard/">Ethereal Engine Admin Panel Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/etherealengine-docs/docs/creator/">Ethereal for Creators</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ethereal for Creators&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/etherealengine-docs/docs/guest/">Ethereal for Guests</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/etherealengine-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/etherealengine-docs/docs/host/"><span itemprop="name">Ethereal for Hosts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/etherealengine-docs/docs/host/devops_deployment/"><span itemprop="name">Deployment</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Ethereal Engine on AWS</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Ethereal Engine on AWS</h1><p>The value <code>RELEASE_NAME</code> referenced throughout this guide is the name of the deployment, e.g. <code>dev</code> or <code>prod</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ways-of-serving-client-files-in-production">Ways of serving client files in production<a href="#ways-of-serving-client-files-in-production" class="hash-link" aria-label="Direct link to Ways of serving client files in production" title="Direct link to Ways of serving client files in production">‚Äã</a></h2><p>There are multiple ways to serve built client files in a production environment.
You should decide how you want to serve them now, because a few later steps will be affected
by that choice, and changing your AWS configuration after everything has been set up one way
is a little tricky:</p><ul><li>From client pods (separate from API pods)</li><li>From API pods</li><li>From the storage provider, such as S3/Cloudfront</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-client-files-from-client-pods">Serve client files from client pods<a href="#serve-client-files-from-client-pods" class="hash-link" aria-label="Direct link to Serve client files from client pods" title="Direct link to Serve client files from client pods">‚Äã</a></h3><p>This is the default method. The Helm charts assume that the deployment will have client pods
to serve client files, and the client ingress will point traffic to the client pods. The client
URL will be pointed to the EKS Load Balancer, and you will not need a separate client certificate.</p><p>This option gives you slightly more flexibility in scaling a deployed cluster than serving
from the API pods, since you can scale the number of API and client pods independently.</p><p>Note that, as of this writing, this is tentatively going to be deprecated by a future re-architecture
of how projects are built and served, and serving from the Storage Provider may end up being the only
allowable option.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-client-files-from-api-pods">Serve client files from API pods<a href="#serve-client-files-from-api-pods" class="hash-link" aria-label="Direct link to Serve client files from API pods" title="Direct link to Serve client files from API pods">‚Äã</a></h3><p>This will make your builder build and serve the client service from the API pods. The Helm
chart will not have a client deployment, serviceaccount, configmap, etc., and the client
ingress will point to the API pods. The client URL will be pointed to the EKS Load Balancer,
and you will not need a separate client certificate.</p><p>To enable this, set client.serveFromApi to <code>true</code> in your Helm config file when you are configuring it.
This needs to be applied to both the builder deployment and the main deployment, but if you set this
before deploying anything, it will be applied to both.</p><p>This option can save you some money by requiring fewer nodes in order to host all of the
API+client pods you desire, as you do not need capacity for separate client pods. It offers
slightly less flexibility in scaling since you cannot scale the number of API and client pods
separately; more client capacity would require more API capacity, and vice versa. It also
will result in slightly longer deployment times, as the combined API+client Docker images
are larger than an API-only or client-only image (though smaller than the sum of the two
separate images), which will mean a few more seconds to download to each node.</p><p>Note that, as of this writing, this is tentatively going to be deprecated by a future re-architecture
of how projects are built and served, and serving from the Storage Provider may end up being the only
allowable option.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-client-files-from-storage-provider-s3--cloudfront">Serve client files from Storage Provider (S3 + Cloudfront)<a href="#serve-client-files-from-storage-provider-s3--cloudfront" class="hash-link" aria-label="Direct link to Serve client files from Storage Provider (S3 + Cloudfront)" title="Direct link to Serve client files from Storage Provider (S3 + Cloudfront)">‚Äã</a></h3><p>This will make the client build process push all of its built files to S3 and serve them via
Cloudfront. Static resources will also be served from the client domain instead of a separate
resources domain. The client URL will be pointed to the Cloudfront distribution, not the EKS Load
Balancer; only API and instanceserver traffic will go to the EKS cluster. You will need a separate
client certificate, but you will not need a resources domain certificate.</p><p>As of this writing, only Amazon S3/Cloudfront is supported as a storage provider
in a cloud environment.</p><p>To enable this, set builder.extraEnv.SERVE_CLIENT_FROM_STORAGE_PROVIDER to <code>true</code> in the
Helm config file when you are configuring it. Also make sure that builder.extraEnv.STORAGE_PROVIDER is set to <code>s3</code>.</p><p>This option can greatly speed up the time it takes for users to fully load your worlds,
since every client file can be served from a CDN close to them, rather than
having to fetch them all from the closest physical server. It will also slightly speed up build times and deployment
times since the client build does not need to be pushed to a Docker repo (though a cache of the build will still
be pushed to speed up future builds).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-eks-cluster-with-four-nodegroups">Create EKS cluster with four nodegroups<a href="#create-eks-cluster-with-four-nodegroups" class="hash-link" aria-label="Direct link to Create EKS cluster with four nodegroups" title="Direct link to Create EKS cluster with four nodegroups">‚Äã</a></h2><p>You first need to set up an EKS cluster for Ethereal Engine to run on.
While this can be done via AWS&#x27; web interface, the <code>eksctl</code> CLI
will automatically provision more of the services you need automatically,
and is thus recommended.</p><p>First, follow <a href="https://docs.aws.amazon.com/eks/latest/userguide/getting-started-eksctl.html" target="_blank" rel="noopener noreferrer">these instructions</a>
for setting up aws-cli, eksctl, and configuring aws-cli with your AWS credentials.
You should also set up kubectl and Helm, as we will be using that to install multiple codebases from Charts.</p><p>Next run the following command:</p><p><code>eksctl create cluster --name &lt;name&gt; --version &lt;version&gt; --region &lt;region&gt; --managed --nodegroup-name &lt;name&gt; --node-type &lt;instance type&gt; --nodes &lt;target_node_number&gt; --nodes-min &lt;minimum_node_number&gt; --nodes-max &lt;maximum_node_number&gt; --spot</code></p><p>This will create an EKS cluster with a managed nodegroup in the specified region, including automatically
creating subnets, making a VPC, and more. It may take up to 15 minutes to complete.</p><p>You can also use the flag <code>--zones &lt;zone1&gt;,&lt;zone2&gt;</code> to specify which Availability Zones the cluster
should set up in. Some regions have zones that are unavailable, but which eksctl will try to
use if --zones is not specified, leading to the setup to fail. As an example, us-west-1 (as of this
writing) does not have any resources available in us-west-1b; if you are setting up in us-west-1,
you would want to use <code>--zones us-west-1a,us-west-1c</code>.</p><p>Note that the region matters for almost all services in AWS. The default region is &#x27;us-east-1&#x27;,
but if you make the cluster in any other region, you&#x27;ll need to make sure you&#x27;re creating certs,
DNS records, etc. in the same region.</p><p>As of this writing, the API and client are configured to run on a nodegroup named &#x27;ng-1&#x27;.
If you name it something else, be sure to change the NodeAffinity in the configuration file. This is one of <strong>four</strong>
nodegroups that will be created for various services to run on.</p><p>Make sure to increase the maximum node limit, as by default target, minimum, and maximum are
set to 2, and Ethereal Engine&#x27;s setup will definitely need more than two nodes if you&#x27;ve configured
them to use relatively small instance types such as t3a.medium.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-ebs-csi-addon-if-eks-version-is-123-or-later">Enable EBS CSI Addon (if EKS version is 1.23 or later)<a href="#enable-ebs-csi-addon-if-eks-version-is-123-or-later" class="hash-link" aria-label="Direct link to Enable EBS CSI Addon (if EKS version is 1.23 or later)" title="Direct link to Enable EBS CSI Addon (if EKS version is 1.23 or later)">‚Äã</a></h4><p>Follow the instructions <a href="https://docs.aws.amazon.com/eks/latest/userguide/managing-ebs-csi.html" target="_blank" rel="noopener noreferrer">here</a>
to enable an EKS addon that&#x27;s required for any cluster that will have Persistent Volumes, which an
Ethereal Engine deployment cluster will.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="install-cluster-autoscaler-optional">Install Cluster Autoscaler (optional)<a href="#install-cluster-autoscaler-optional" class="hash-link" aria-label="Direct link to Install Cluster Autoscaler (optional)" title="Direct link to Install Cluster Autoscaler (optional)">‚Äã</a></h4><p>While not necessary, it can be useful to have an autoscaler installed in the cluster to increase
the number of nodes available for pods when the cluster has high traffic and to decrease that
number when it has low traffic.</p><p>Follow <a href="https://docs.aws.amazon.com/eks/latest/userguide/autoscaling.html#cluster-autoscaler" target="_blank" rel="noopener noreferrer">these instructions</a>
to set up the autoscaler. Any managed nodegroups created in the following steps should by default be
tagged such that the autoscaler can control them, so no further action should be required.</p><p>Note that there is some lag time on scaling up and down. It generally takes about 5 minutes from
the time that the autoscaler sees the need to add more nodes before those nodes have been spun up,
the appropriate Docker image has been installed onto them, and they are ready to be used. It takes about
15 minutes for the autoscaler to actually remove nodes that are deemed superfluous, as a hedge against
the recent high traffic picking up again.</p><p>The OIDC provider that was created in the prior step, installing the EBS CSI Addon, can be re-used in this step.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-launch-template">Create launch template<a href="#create-launch-template" class="hash-link" aria-label="Direct link to Create launch template" title="Direct link to Create launch template">‚Äã</a></h4><p>Go to EC2 -&gt; Launch Templates and make a new one. Name it something like &#x27;etherealengine-production-instanceserver&#x27;.
Most settings can be left as-is, except for the following:</p><ul><li>Storage -&gt; Add a volume, set the size to ~20GB, and for Device name select &#x27;/dev/xvda&#x27;.</li><li>Network Interfaces -&gt; Add one, and under &#x27;Auto-assign public IP&#x27; select &#x27;Enable&#x27;</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-nodegroup-for-instanceservers">Create nodegroup for instanceservers<a href="#create-nodegroup-for-instanceservers" class="hash-link" aria-label="Direct link to Create nodegroup for instanceservers" title="Direct link to Create nodegroup for instanceservers">‚Äã</a></h4><p>Go to the AWS website, then go to EKS -&gt; Clusters -&gt; click on the cluster you just made -&gt; Configuration -&gt; Compute.
You should see one managed nodegroup already there; clicking on its name will open up information
and editing, though you can&#x27;t change the instance type after it&#x27;s been made.</p><p>Back at the Compute tab, click on Add Node Group. Pick a name (something like ng-instanceservers-1 is recommended),
select the IAM role that was created with the cluster (it should be something like <code>eksctl-&lt;cluster_name&gt;-node-NodeInstanceRole-&lt;jumble_of_characters&gt;</code>),
toggle the Use Launch Template toggle and select the launch template you made in the previous step,
then click Next. On the second page, Choose the instance type(s) you&#x27;d like for the group,
set the minimum/maximum/desired scaling sizes, and hit Next (t3(a).smalls are recommended).
There may be connection issues with instanceserver instances in private subnets, so remove all of the private
subnets from the list of subnets to use, and make sure that public subnets are being used (sometimes
the workflow only selects private subnets by default). Hit Next, review everything, and click Create.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-nodegroup-for-redis">Create nodegroup for redis<a href="#create-nodegroup-for-redis" class="hash-link" aria-label="Direct link to Create nodegroup for redis" title="Direct link to Create nodegroup for redis">‚Äã</a></h4><p>Redis should get its own nodegroup to isolate it from any other changes that might be made to your cluster.
As with the instanceserver nodegroup, it&#x27;s not strictly necessary, but can prevent various other things from
going down due to the redis servers getting interrupted.</p><p>Back at the Compute tab, click on Add Node Group. Pick a name (the default config in <a href="https://github.com/EtherealEngine/ethereal-engine-ops/blob/master/configs/local.minikube.template.values.yaml" target="_blank" rel="noopener noreferrer">ethereal-engine-ops</a> assumes
a name of &#x27;ng-redis-1&#x27;), select the IAM role that was created with the cluster
(it should be something like <code>eksctl-&lt;cluster_name&gt;-node-NodeInstanceRole-&lt;jumble_of_characters&gt;</code>),
toggle the Use Launch Template toggle and select the launch template used to make the initial nodegroup,
then click Next. On the second page, Choose the instance type(s) you&#x27;d like for the group,
set the minimum/maximum/desired scaling sizes (you can probably get away with a single t3(a).small, but it&#x27;s recommended
to have at least two nodes so that one going down doesn&#x27;t kill the entire deployment from a lack of redis), and hit Next.
The default subnets should be fine, so hit Next, review everything, and click Create.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-nodegroup-for-builder">Create nodegroup for builder<a href="#create-nodegroup-for-builder" class="hash-link" aria-label="Direct link to Create nodegroup for builder" title="Direct link to Create nodegroup for builder">‚Äã</a></h4><p>The full Ethereal Engine stack needs a builder server within the cluster in order to bundle and build
Ethereal Engine projects into the codebase that will be deployed. This should run on its own nodegroup
that has a single node - only one copy of the builder should ever be running at a time, and
due to the high memory needs of building the client service, a box with &gt;8 GB of RAM is needed.</p><p>Back at the Compute tab, click on Add Node Group. Pick a name (something like <code>ng-dev-builder-1</code> is recommended) and
select the IAM role that was created with the cluster (it should be something like
<code>eksctl-&lt;cluster_name&gt;-node-NodeInstanceRole-&lt;jumble_of_characters&gt;</code>). You don&#x27;t need to use any Launch Template
for this nodegroup. Click Next.</p><p>On the second page, you can change the Capacity Type to <code>Spot</code> if you want to in order to save money; the builder
service will likely not be running very often or for too long, so the odds of it getting interrupted by Spot instance
outages are low, and it can always re-build if that does happen. Set the Disk Size to 50 GB; it takes a good deal of
disk space to install and build the Ethereal Engine codebase, and the default 20 GB will almost certainly not be enough.</p><p>For Instance Types, you need to only select types that have more than 8 GB; t3a.xlarge are the cheapest that fit
this criteria. If you were to pick something with 8GB, it&#x27;s highly likely that most builds would crash the node,
as Kubernetes tends to restart nodes if they get anywhere near memory capacity.
Under Node Group Scaling Configuration, set all three <code>nodes</code> values to 1. We only want a single copy of the builder
at any given time, and running multiple powerful boxes can get pricey. Click Next.</p><p>You can leave the subnets on the next page alone and click Next. On the last page, click Create.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-ecr-repositories-for-built-images">Create ECR repositories for built images.<a href="#create-ecr-repositories-for-built-images" class="hash-link" aria-label="Direct link to Create ECR repositories for built images." title="Direct link to Create ECR repositories for built images.">‚Äã</a></h2><p>The Ethereal Engine deployment process will be building multiple Docker images, and those need to be stored somewhere.
In AWS, that somewhere is <a href="https://us-west-1.console.aws.amazon.com/ecr/get-started" target="_blank" rel="noopener noreferrer">Elastic Container Registry</a>.
You need to make those repositories in the same AWS region where the EKS cluster is running.</p><p>Go to the ECR link above and click Get Started under Create a Repository. If you&#x27;re very concerned about any of your
Ethereal Engine project codebase(s) getting out, you can choose Private for Visibility Settings, but normally Public is fine.
You&#x27;ll be needing to create multiple repositories for each deployment, e.g. several repos for a <code>dev</code> deployment,
several more for a <code>prod</code> deployment, etc.</p><p>Assuming you&#x27;re first doing a <code>dev</code> deployment, name the first repo <code>etherealengine-&lt;RELEASE_NAME&gt;-builder</code> under Repository
Name, e.g. <code>etherealengine-dev-builder</code>. You shouldn&#x27;t need to change any other settings, though if you&#x27;re using a Private
repo and want to turn on Tag Immutability, that&#x27;s fine. The image tags that are generated should never collide, but it
will prevent any manual overwriting of a tag. Click Create Repository.</p><p>You will need to make four more repos for each of the services that are deployed as part of the Ethereal Engine stack -
<code>api</code>, <code>client</code>, <code>instanceserver</code> and <code>taskserver</code>, which are also in the form <code>etherealengine-&lt;RELEASE_NAME&gt;-&lt;service_name&gt;</code>.
e.g. <code>etherealengine-dev-api</code>, <code>etherealengine-dev-client</code>, <code>etherealengine-dev-instanceserver</code> and <code>etherealengine-dev-taskserver</code>.
Everything else can be left alone for those, too.</p><p>On the <a href="https://us-west-1.console.aws.amazon.com/ecr/repositories" target="_blank" rel="noopener noreferrer">repositories page</a>, you should see both of
the repositories you made. If you don&#x27;t see any, you may be on the wrong tab up top - click Private or Public to switch
between them. Also check that you&#x27;re in the right AWS region. You&#x27;ll see a column &#x27;URI&#x27;. If you made public repos,
the URIs should be in the form <code>public.ecr.aws/&lt;identifier&gt;/etherealengine-&lt;RELEASE_NAME&gt;(-builder)</code>; if you made private
repos, the URIs should be in the form <code>&lt;AWS_account_id&gt;.dkr.ecr.&lt;AWS_region&gt;.amazonaws.com/etherealengine-&lt;deployment&gt;(-builder)</code>.
Take note of everything before the <code>/etherealengine-&lt;RELEASE_NAME&gt;</code> - you&#x27;ll need to add that as a variable in later steps.
It will be called <code>ECR_URL</code> there.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-iam-roles-for-s3sessns-or-a-single-admin-role">Create IAM Roles for S3/SES/SNS (or a single admin role)<a href="#create-iam-roles-for-s3sessns-or-a-single-admin-role" class="hash-link" aria-label="Direct link to Create IAM Roles for S3/SES/SNS (or a single admin role)" title="Direct link to Create IAM Roles for S3/SES/SNS (or a single admin role)">‚Äã</a></h2><p>Ethereal Engine interfaces with several AWS services and requires credentials for these purposes. You could make
one admin role with full access to all AWS services, but we recommend making separate, scoped roles for
each individual service. To create a role, do the following:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-iam-role">Creating an IAM role<a href="#creating-an-iam-role" class="hash-link" aria-label="Direct link to Creating an IAM role" title="Direct link to Creating an IAM role">‚Äã</a></h3><p>Go to IAM-&gt;Users, and click on the Add User button. For User Name, enter <code>&lt;service&gt;-admin</code>, e.g. <code>S3-admin</code>.
Check the box for Programmatic Access, the click on the Next:Permissions button.
Click on &#x27;Attach existing policies directly&#x27;. In the Filter Policies text box, you&#x27;ll want to
enter the name of the service to narrow down the policy list significantly. Then, look for the FullAccess
policy for that service and select that, and click the Next:Tags button. You don&#x27;t need to tag it with
anything, just click the Next:Review button, then the Create User button.</p><p>The following screen should show Success and have the user listed. Copy the &#x27;Access key ID&#x27; somewhere, and
also click the Show toggle under &#x27;Secret access key&#x27; and copy that elsewhere as well. You will put these
into the Helm config file later.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iam-roles-to-create">IAM Roles to create<a href="#iam-roles-to-create" class="hash-link" aria-label="Direct link to IAM Roles to create" title="Direct link to IAM Roles to create">‚Äã</a></h3><p>Here are the services you want to create IAM admin users for, and the associated permissions you want to
grant them:</p><ul><li>S3: <code>AmazonS3FullAccess, CloudFrontFullAccess</code></li><li>SNS: <code>AmazonSNSFullAccess</code></li></ul><p>You&#x27;ll also need to create an IAM user that GitHub Actions can use to access the cluster and push/pull
Docker images from ECR. By convention, we call this user &#x27;EKSUser&#x27;, and it needs these
permissions: <code>AmazonEKSClusterPolicy, AmazonEKSWorkerNodePolicy, AmazonEKSServicePolicy, AmazonElasticContainerRegistryPublicFullAccess, AmazonEC2ContainerRegistryFullAccess</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-new-credentials-for-an-iam-user">Creating new credentials for an IAM user<a href="#creating-new-credentials-for-an-iam-user" class="hash-link" aria-label="Direct link to Creating new credentials for an IAM user" title="Direct link to Creating new credentials for an IAM user">‚Äã</a></h3><p>If you ever lose the secret to a user, or want to make new credentials for whatever reason, go to
IAM-&gt;Users and click on that user. Click on the &#x27;Security credentials&#x27; tab, and under &#x27;Access keys&#x27; you
should see a button &#x27;Create access key&#x27; and, underneath that, 0-2 existing keys with some information
about them and an &#x27;x&#x27; on the far right to delete it. If there are two keys for that user, you
must deactivate and delete one of them before making a new one.</p><p>Click the Create button, then make sure to save the public and secret keys somewhere and put them into
the Helm config file.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-rds-box">Create RDS box<a href="#create-rds-box" class="hash-link" aria-label="Direct link to Create RDS box" title="Direct link to Create RDS box">‚Äã</a></h2><p>Ethereal Engine is backed by a SQL server. We use MariaDB in development, but it has also been run on AWS with
Aurora without issue. Most other versions of SQL should work but have not been explicitly tested.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-rds-box-from-an-external-machine">Accessing RDS box from an external machine<a href="#accessing-rds-box-from-an-external-machine" class="hash-link" aria-label="Direct link to Accessing RDS box from an external machine" title="Direct link to Accessing RDS box from an external machine">‚Äã</a></h3><p>By default, an RDS box is only accessible from within the VPC it&#x27;s located.
If you want to be able to connect to it from outside that VPC, you&#x27;ll need to either set up a bastion box
and SSH into that box, or make the RDS box publicly accessible.</p><p>Setting up a bastion box is not covered here at this time. The steps to make it public will be noted
below by <strong>Make RDS public</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-rds-instance">Create RDS instance<a href="#create-rds-instance" class="hash-link" aria-label="Direct link to Create RDS instance" title="Direct link to Create RDS instance">‚Äã</a></h3><p>Go to RDS and click the Create Database button. Most options can be left at their default values.
Under Settings, give a more descriptive DB cluster identifier. The Master Username can be left as admin;
enter a Master Password and then enter it again in Confirm Password.</p><p>Under DB instance class, pick an option that best meets your pricing needs.</p><p>Under Availability and Durability, it&#x27;s recommended that you leave it on the default of
making an Aurora Replica in another AZ.</p><p>Under Connectivity, make sure that it&#x27;s in the VPC that was made as part of the EKS cluster.</p><p><strong>Make RDS public</strong>
If you want to be able to access it externally, you should set Public Access to &#x27;Yes&#x27;.</p><p>Under VPC security group, select the ones titled
<code>eksctl-&lt;EKS_cluster_name&gt;-cluster-ClusterSharedNodeSecurityGroup-&lt;random_string&gt;</code> and
<code>eks-clustersg-&lt;EKS_cluster_name&gt;-&lt;random_string&gt;</code>.</p><p>Open the top-level Additional Configuration dropdown (not the one within Connectivity). Under Database Options-&gt; Initial Database Name,
name the default database and save this for later use in the Helm config file.</p><p>Finally, click the Create Database button at the very bottom of the page.</p><p><strong>Make RDS Public</strong> You will need to add a Security Group to the RDS instance that allows traffic over port
3306 (or whatever port you chose to run it on). You can have this SG only let in traffic from your IP address(es)
if you want to be very secure about this, or from anywhere (0.0.0.0/0) if you&#x27;re less concerned about someone
getting access.</p><p>Some values to note for dev/prod.template.values.yaml:
sql.database will be what you entered for Initial Database Name
sql.user and sql.password will be the name and password of the admin user
sql.host will be the Endpoint of the RDS instance/cluster; find this by going to RDS -&gt; Databases,
clicking on either the lone DB identifier (if made in a single AZ) or the top-level regional cluster
identifier (if set up in a multi-AZ deployment); the look for Endpoint (single-AZ) or, if multi-AZ,
the Endpoint name that has type &#x27;Writer instance&#x27;.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="edit-security-group-to-allow-instanceserver-traffic-into-vpc">Edit security group to allow instanceserver traffic into VPC<a href="#edit-security-group-to-allow-instanceserver-traffic-into-vpc" class="hash-link" aria-label="Direct link to Edit security group to allow instanceserver traffic into VPC" title="Direct link to Edit security group to allow instanceserver traffic into VPC">‚Äã</a></h2><p>You&#x27;ll need to edit the new cluster&#x27;s main security group to allow instanceserver traffic.
On the AWS web client, go to EC2 -&gt; Security Groups. There should be three SGs that have
the node&#x27;s name somewhere in their name; look for the one that is in the form
<code>eks-cluster-sg-&lt;cluster_name&gt;-&lt;random_numbers&gt;</code>. It should NOT end with /ControlPlaneSecurityGroup
or /ClusterSharedNodeSecurityGroup.
Click on that, then the Inbound Rules tab, then click Edit Inbound Rules.</p><p>You&#x27;ll need to add two rule sets:</p><ul><li>Type: Custom UDP; Port Range: 7000-8000; Source: Anywhere (or &#x27;Custom 0.0.0.0/0&#x27;)</li><li>Type: Custom TCP; Port Range: 7000-8000; Source: Anywhere (or &#x27;Custom 0.0.0.0/0&#x27;)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-route-53-hosted-zone-and-set-up-acm-certificates">Create Route 53 Hosted Zone and set up ACM certificates<a href="#create-route-53-hosted-zone-and-set-up-acm-certificates" class="hash-link" aria-label="Direct link to Create Route 53 Hosted Zone and set up ACM certificates" title="Direct link to Create Route 53 Hosted Zone and set up ACM certificates">‚Äã</a></h2><p>Before installing Nginx to the cluster, you&#x27;ll need to have all of the networking squared away.
This requires creating the necessary SSL certificates and creating some DNS records to point
various subdomains to the right place.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="purchase-and-register-domain-through-route53-optional">Purchase and register domain through Route53 (optional)<a href="#purchase-and-register-domain-through-route53-optional" class="hash-link" aria-label="Direct link to Purchase and register domain through Route53 (optional)" title="Direct link to Purchase and register domain through Route53 (optional)">‚Äã</a></h3><p>If you do not have a domain for your application already, it&#x27;s easiest to register it through Route53.
Go to Route53-&gt;Domains-&gt;Registered domains, then click the &#x27;Register Domain&#x27; button, and follow the
workflow to register a domain name.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-route-53-hosted-zone">Create Route 53 Hosted Zone<a href="#create-route-53-hosted-zone" class="hash-link" aria-label="Direct link to Create Route 53 Hosted Zone" title="Direct link to Create Route 53 Hosted Zone">‚Äã</a></h3><p>In the AWS web client, go to Route 53. Make a hosted zone for the domain you plan to use for
your setup of Ethereal Engine. You&#x27;ll be coming back here later to create DNS records.</p><p>Open the Hosted zone, then click on &#x27;Hosted zone details&#x27; to see more information. The value &#x27;Hosted zone id&#x27;
is used in the dev/prod.values.yaml file for &#x27;ROUTE53_HOSTED_ZONE_ID&#x27;</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="point-external-registrar-subdomains-to-use-route53-nameservers-only-if-your-domain-is-registered-outside-route53">Point external registrar subdomains to use Route53 Nameservers (only if your domain is registered outside Route53)<a href="#point-external-registrar-subdomains-to-use-route53-nameservers-only-if-your-domain-is-registered-outside-route53" class="hash-link" aria-label="Direct link to Point external registrar subdomains to use Route53 Nameservers (only if your domain is registered outside Route53)" title="Direct link to Point external registrar subdomains to use Route53 Nameservers (only if your domain is registered outside Route53)">‚Äã</a></h4><p>If you already have a domain registered with another registrar service, you&#x27;ll need to add some DNS records
in there to point the specific subdomains you&#x27;ll be using to AWS&#x27; nameservers.</p><p>First, go to Route53-&gt;Hosted Zones and open the domain you&#x27;ll be using by clicking on the domain name (or
highlighting the row and clicking the &#x27;View details&#x27; button). There should be two records under Records.
Look for the one of type &#x27;NS&#x27;; under &#x27;Value/Route traffic to&#x27;, there should be four lines that all start
with &#x27;ns-&#x27;. These will be used shortly.</p><p>Go to your external registrar and go to the DNS records page. For each subdomain that will be in use, you
need to add four records of type &#x27;NS&#x27;. The Name wil be the subdomain, and the Nameserver will be one of
the four lines under the &#x27;NS&#x27;. You need a record for each of the four lines.</p><p>If you&#x27;re setting up multiple deployments, e.g. both a dev and prod deployment, you&#x27;ll need a set of four
NS records for each subdomain that those deployments will be behind.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-certificates-with-acm">Create certificates with ACM<a href="#create-certificates-with-acm" class="hash-link" aria-label="Direct link to Create certificates with ACM" title="Direct link to Create certificates with ACM">‚Äã</a></h3><p>Go to Amazon Certificate Manager. If there are no certs in that region, click on Get Started under Provision Certificates,
otherwise click on Request a Certificate.</p><p>You should select Request a Public Certificate, then select Request a Certificate. The next page
should be headed Add Domain Names. You should add both the top-level domain, such as <code>etherealengine.org</code>,
as well as a wildcard for all subdomains e.g. <code>*.etherealengine.org</code>, then click Next.</p><p>Choose DNS Validation on the next page and click Next. You can skip adding tags and just click Review,
then Confirm on the final page.</p><p>You should be sent to a page headed Validation. Click on the arrow next to each domain to open more
options. Click on the button Create Record in Route 53 to open a confirmation modal, and in that modal
click Create.</p><p>As it indicates, it can take up to 30 minutes for these domains to be validated. If you click on Complete
after triggering the record creation for each of them, you should be sent back to the Certificates page.
Opening the cert you just made will show the validation status of each domain.</p><p>If you open the details of this certificate, there should be a field &#x27;ARN&#x27; with a value that looks
something like <code>arn:aws:acm:&lt;region&gt;:&lt;AWS account ID&gt;:certificate/&lt;a UUID&gt;</code>. Take note of this for later,
when you go to install ingress-nginx.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="if-you-are-serving-client-files-from-client-or-api-pods">If you are serving client files from client or API pods<a href="#if-you-are-serving-client-files-from-client-or-api-pods" class="hash-link" aria-label="Direct link to If you are serving client files from client or API pods" title="Direct link to If you are serving client files from client or API pods">‚Äã</a></h4><p>You should follow the above instructions to make a second certificate for <code>resources.&lt;domain&gt;</code>.
Note that this certificate MUST be made in us-east-1, regardless of which region everything else is
set up in; as of this writing, CloudFront can only use certificates in us-east-1.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="if-you-are-serving-client-files-from-the-storage-provider">If you are serving client files from the Storage Provider<a href="#if-you-are-serving-client-files-from-the-storage-provider" class="hash-link" aria-label="Direct link to If you are serving client files from the Storage Provider" title="Direct link to If you are serving client files from the Storage Provider">‚Äã</a></h4><p>You should follow the above instructions to make a second certificate for <code>&lt;RELEASE_NAME&gt;.&lt;domain&gt;</code>.
Note that this certificate MUST be made in us-east-1, regardless of which region everything else is
set up in; as of this writing, CloudFront can only use certificates in us-east-1.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-agones-ingress-nginx-and-a-copy-of-redis-for-each-deployment">Install Agones, ingress-nginx, and a copy of redis for each deployment<a href="#install-agones-ingress-nginx-and-a-copy-of-redis-for-each-deployment" class="hash-link" aria-label="Direct link to Install Agones, ingress-nginx, and a copy of redis for each deployment" title="Direct link to Install Agones, ingress-nginx, and a copy of redis for each deployment">‚Äã</a></h2><p>Now that the cluster is up and running, we can install everything onto it.
When you created the cluster with eksctl, it should have created a context pointing to
it in kubectl. Run <code>kubectl config get-contexts</code> to get all of the contexts it knows about;
the one with a star next to it should be named <code>&lt;your_AWS_username&gt;@&lt;cluster_name&gt;</code>.
If that isn&#x27;t present, you&#x27;ll have to edit the configuration to make the appropriate context.</p><p>You next need to add the Agones, ingress-nginx, and redis Helm charts to helm by running
<code>helm repo add agones https://agones.dev/chart/stable</code>, <code>helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx</code>, and <code>helm repo add redis https://charts.bitnami.com/bitnami</code>.
You should also at this time add Ethereal Engine&#x27;s repo via <code>helm repo add etherealengine https://helm.etherealengine.org</code>.</p><p>If you ever suspect that a chart is out-of-date, run <code>helm repo update</code> to update all of them to the latest.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-agones">Install Agones<a href="#install-agones" class="hash-link" aria-label="Direct link to Install Agones" title="Direct link to Install Agones">‚Äã</a></h3><p>From the top level of this repo, run <code>helm install -f &lt;/path/to/agones-default-values.yaml&gt; agones agones/agones</code>.
This says to install a service called &#x27;agones&#x27; from the &#x27;agones&#x27; package in the &#x27;agones&#x27; chart, and to configure it with
<a href="https://github.com/EtherealEngine/ethereal-engine-ops/blob/master/configs/agones-default-values.yaml" target="_blank" rel="noopener noreferrer">agones-default-values.yaml</a> that can be found in <a href="https://github.com/EtherealEngine/ethereal-engine-ops" target="_blank" rel="noopener noreferrer">ethereal-engine-ops</a> repo.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-redis-for-each-deployment">Install redis for each deployment<a href="#install-redis-for-each-deployment" class="hash-link" aria-label="Direct link to Install redis for each deployment" title="Direct link to Install redis for each deployment">‚Äã</a></h3><p>Each deployment of Ethereal Engine uses a redis cluster for coordinating the &#x27;feathers-sync&#x27; library.
Each redis deployment needs to be named the same as the deployment that will use it; for an
Ethereal Engine deployment named &#x27;dev&#x27;, the corresponding redis deployment would need to be named
&#x27;dev-redis&#x27;.</p><p>Run <code>helm install -f &lt;/path/to/redis-values.yaml&gt; &lt;RELEASE_NAME&gt;-redis redis/redis</code> to install, e.g.
<code>helm install -f &lt;/path/to/redis-values.yaml&gt; dev-redis redis/redis</code>.</p><blockquote><p><a href="https://github.com/EtherealEngine/ethereal-engine-ops/blob/master/configs/redis-values.yaml" target="_blank" rel="noopener noreferrer">redis-values.yaml</a> can be found in <a href="https://github.com/EtherealEngine/ethereal-engine-ops" target="_blank" rel="noopener noreferrer">ethereal-engine-ops</a> repo.</p></blockquote><p>If you named the redis nodegroup something other than &#x27;ng-redis-1&#x27;, you&#x27;ll have to alter the value in
<code>redis-values.yaml</code> in two places to your redis nodegroup name.
If you didn&#x27;t create a nodegroup just for redis, you must omit the <code>-f &lt;/path/to/redis-values.yaml&gt;</code>,
as that config makes redis pods run on a specific nodegroup.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="installing-redis-as-part-of-ethereal-engine-chart-not-recommended-for-production">Installing redis as part of Ethereal Engine chart (not recommended for production)<a href="#installing-redis-as-part-of-ethereal-engine-chart-not-recommended-for-production" class="hash-link" aria-label="Direct link to Installing redis as part of Ethereal Engine chart (not recommended for production)" title="Direct link to Installing redis as part of Ethereal Engine chart (not recommended for production)">‚Äã</a></h4><p>Redis can be installed as part of the Ethereal Engine chart so long as the config file for the Ethereal Engine installation has &#x27;redis.enabled&#x27; set to true.
In that case, you should skip the above step of installing redis separately. This is not recommended for production
environments, though, since upgrades to an Ethereal Engine installation will usually reboot the redis servers,
leading all of the instanceservers to crash due to their redis connections being severed.</p><p>This breaks Agones&#x27; normal behavior of keeping Allocated instanceservers running until every user has left and slowly replacing
old Ready instanceservers with new ones, maintaining an active pool of instanceservers at all times. You will encounter a period
of time where there are no active instanceservers at all, which is not recommended, and all instanceservers in use
will immediately go down.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-ingress-nginx">Install ingress-nginx<a href="#install-ingress-nginx" class="hash-link" aria-label="Direct link to Install ingress-nginx" title="Direct link to Install ingress-nginx">‚Äã</a></h3><p><strong>This step cannot finish until the associated ACM Certificate is fully validated</strong>
Open local version of <a href="https://github.com/EtherealEngine/ethereal-engine-ops/blob/master/configs/nginx-ingress-aws-values.yml" target="_blank" rel="noopener noreferrer">nginx-ingress-aws-values.yml</a> file. Take note of the line
<code>service.beta.kubernetes.io/aws-load-balancer-ssl-cert: &quot;&lt;ACM Certificate ARN for SSL&gt;&quot;</code>
Replace the bit in angle brackets, including the angle brackets, with the ARN of the certificate
you made for the top-level domain and all wildcarded subdomains, e.g.
<code>service.beta.kubernetes.io/aws-load-balancer-ssl-cert: &quot;arn:aws:acm:us-west-1:103947711118:certificate/aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa&quot;</code></p><p>Do not commit this file with the ARN inserted; once you&#x27;ve completed this step, revert the file back
to the state it was committed in.</p><p>From the top level of this repo, run <code>helm install -f &lt;/path/to/nginx-ingress-aws-values.yml&gt; nginx ingress-nginx/ingress-nginx</code>
This says to install a service called &#x27;nginx&#x27; from the &#x27;ingress-nginx&#x27; package in the &#x27;ingress-nginx&#x27; chart, and to configure it with
a file found at <a href="https://github.com/EtherealEngine/ethereal-engine-ops/blob/master/configs/nginx-ingress-aws-values.yml" target="_blank" rel="noopener noreferrer">nginx-ingress-aws-values.yml</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-simple-email-service-optional">Set up Simple Email Service (optional)<a href="#set-up-simple-email-service-optional" class="hash-link" aria-label="Direct link to Set up Simple Email Service (optional)" title="Direct link to Set up Simple Email Service (optional)">‚Äã</a></h2><p>If you want to enable email magiclink login, you will need to set up Simple Email Service (SES).</p><p>In the AWS web client, go to SES -&gt; Configuration -&gt; Verified Identities. Click Create Identity, then under &#x27;Identity type&#x27;
select &#x27;Domain&#x27;. Enter the top-level domain under the &#x27;Domain&#x27; field. Finally, click the &#x27;Create identity&#x27; button.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-smtp-credentials">Create SMTP credentials<a href="#create-smtp-credentials" class="hash-link" aria-label="Direct link to Create SMTP credentials" title="Direct link to Create SMTP credentials">‚Äã</a></h3><p>You need to create SMTP credentials in order to authorize SES. These will show up as an IAM user,
but you must go through an SES-specific process to get valid credentials; just creating an IAM user
with SESFullAccess will not work.</p><p>Go to an SES page and select &#x27;SMTP Settings&#x27;, then click the button &#x27;Create SMTP Credentials&#x27;.
You can leave the default IAM User Name as-is; click the Create button. You should be taken to a screen
says a user has been created successfully. Click on &#x27;Show User SMTP Security Credentials&#x27;.</p><p>You will see a Username and Password. These credentials will go into the Helm config file, under
AWS_SMTP_USER and AWS_SMTP_PASS, respectively. You must also fill in the region that you&#x27;ve created these credentials
in, replacing &lt;SES_REGION&gt; in api.extraEnv.SMTP_HOST.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="move-ses-out-of-sandbox">Move SES out of Sandbox<a href="#move-ses-out-of-sandbox" class="hash-link" aria-label="Direct link to Move SES out of Sandbox" title="Direct link to Move SES out of Sandbox">‚Äã</a></h3><p>By default, SES domains are in Sandbox mode, where they can only send emails to verified email addresses.
To request that the domain be moved out of Sandbox mode, go to SES-&gt;Email Sending-&gt;Sending Statistics.
Click on the button &#x27;Edit your account details&#x27; to open the modal. Set &#x27;Enable Production Access&#x27; to Yes,
leave Mail type on &#x27;Transactional&#x27;, then fill in the Website URL, add a Use case description (basically
just assure them that this is for account login only, not anything else), click the checkbox to agree
to their TOD, and click the button &#x27;Submit for review&#x27;.</p><p>It may take up to a few days for them to take action. If the request is rejected, address their concerns.
Once you have been approved, email login should work for any email address.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-test-emails">Verifying test emails<a href="#verifying-test-emails" class="hash-link" aria-label="Direct link to Verifying test emails" title="Direct link to Verifying test emails">‚Äã</a></h4><p>Before you have production use for your SES domain, in order to log in you&#x27;ll have to verify specific email
addresses with SES. Go to SES-&gt;Identity Management-&gt;Email Addresses. Click on the button &#x27;Verify a New Email
Address&#x27;. Enter the address you want to test with, then click &#x27;Verify This Email Address&#x27;. You should soon
receive an email with a link to verify it (it may go to your Spam folder). Once you&#x27;ve followed the link,
you can log in with that address.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-simple-notification-service-optional">Set up Simple Notification Service (optional)<a href="#set-up-simple-notification-service-optional" class="hash-link" aria-label="Direct link to Set up Simple Notification Service (optional)" title="Direct link to Set up Simple Notification Service (optional)">‚Äã</a></h2><p>If you want to enable text message-based magiclink login, you will need to set up Simple Notification Service (SNS).</p><p>In the AWS web client, go to SNS -&gt; Topics and Create a new topic.
Give it a name, and selected &#x27;Standard&#x27; as the type, then click Create Topic.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-s3-bucket-for-static-resources-and-cloudfront-distribution">Set up S3 bucket for static resources and Cloudfront distribution<a href="#set-up-s3-bucket-for-static-resources-and-cloudfront-distribution" class="hash-link" aria-label="Direct link to Set up S3 bucket for static resources and Cloudfront distribution" title="Direct link to Set up S3 bucket for static resources and Cloudfront distribution">‚Äã</a></h2><p>Various static files are stored in S3 behind a Cloudfront distribution. If you are serving the client files
from the Storage Provider, then all client files will be stored and served from these as well.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-s3-bucket">Create S3 bucket<a href="#create-s3-bucket" class="hash-link" aria-label="Direct link to Create S3 bucket" title="Direct link to Create S3 bucket">‚Äã</a></h3><p>In the AWS web client, go to S3 -&gt; Buckets and click Create Bucket.
Name the bucket <code>&lt;name&gt;-static-resources</code>, e.g. <code>etherealengine-static-resources</code>, and have it be in Region us-east-1.
Under Object Ownership, select &#x27;ACLs enabled&#x27;, and under that select &#x27;Object Writer&#x27;.
Under Block Public Access Settings For The Bucket, uncheck the checkbox Block <em>all</em> Public Access;
you need the bucket to be publicly accessible.
Check the box that pops up confirming that you know the contents are public.
All other settings can be left to their default values; click Create Bucket.</p><p>Open the bucket&#x27;s settings and go the Permissions tab. Midway down is &#x27;Access control list&#x27;. Edit that, and
Check the boxes for Objects:List and Bucket ACL:Read for &#x27;Everyone (public access)&#x27;. Click the box with the
warning label that appears that says &quot;I understand the effects of these changes on my objects and buckets&quot;,
then click Save Changes.
At the bottom of the Permissions tab is a Cross-origin Resource Sharing (CORS) box.
It should have the following settings; if not, click Edit and copy this in:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;AllowedHeaders&quot;: [],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;AllowedMethods&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;HEAD&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;GET&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;POST&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;AllowedOrigins&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;*&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;ExposeHeaders&quot;: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-cloudfront-distribution">Create Cloudfront distribution<a href="#create-cloudfront-distribution" class="hash-link" aria-label="Direct link to Create Cloudfront distribution" title="Direct link to Create Cloudfront distribution">‚Äã</a></h3><p>In the AWS web client, go to Cloudfront -&gt; Distributions and click on Create Distribution.
Under &#x27;Web&#x27;, click on Get Started.</p><p>Under <code>Origin</code>, click on the text box under <code>Origin domain</code>, and select the name of the S3 bucket you just made.
The <code>Name</code> field should be automatically populated, and should be left as whatever that value is.</p><p>Several fields in <code>Default cache behavior</code> will be changed.</p><p>Under <code>Viewer -&gt; Viewer protocol policy</code>, select &#x27;Redirect HTTP to HTTPS&#x27;
Under <code>Viewer -&gt; Allowed HTTP methods</code>, select &#x27;GET, HEAD, OPTIONS&#x27;, and check <code>Cache HTTP methods -&gt; OPTIONS</code>.</p><p>In <code>Cache key and origin requests</code>, leave it on <code>Cache policy and origin request policy</code>.
If this option is not available, see the below subsection for <code>Legacy cache settings</code></p><p>For <code>Cache policy</code>, you will need to make a new policy, which is easily done by clicking the link <code>Create policy</code>
underneath the selector; this will open a new tab. Name this policy anything you want, e.g. &#x27;Cached-on-headers&#x27;,
then under <code>Cache key settings</code>, click on the <code>Headers</code> selector and select &#x27;Include the following headers&#x27;. A new
selector should appear under that titled <code>Add header</code>. Click the selector, and check &#x27;Origin&#x27;,
&#x27;Access-Control-Request-Method&#x27;, and &#x27;Access-Control-Request-Headers&#x27;, then click away from the menu. Click the &#x27;Create&#x27;
button to create the new policy.</p><p>Once the policy has been created, go back to the tab that you were creating the CloudFront distribution in.
Click the refresh button to the right of the <code>Cache policy</code> selector to fetch your new policy, then click the selector,
and your new policy should appear in the selector at the bottom of the list under the header &#x27;Custom&#x27;. Select it.</p><p>For <code>Origin request policy</code>, select the option &#x27;CORS-S3Origin&#x27;.</p><p>You should also make a custom response header policy so that files are served with the <code>Origin-Agent-Cluster</code>
header, which will tell most browsers to isolate resources for same-site cross-origin requests. To do that,
you will need to make a custom response header policy. Under <code>Response headers policy</code>, select <code>Create Policy</code>.
This will open a separate tab. Name this something like <code>Origin-Agent-Cluster</code>, then under <code>Custom headers</code>,
click <code>Add header</code>. For name, enter <code>Origin-Agent-Cluster</code>, and for <code>Value</code>, enter <code>?1</code>. Then click the <code>Create</code>
button at the bottom.</p><p>Go back to the tab where you were creating the Cloudfront distribution. Click the refresh button to the right of
the <code>Response headers policy</code> selector to fetch the new policy, then click the selector, and your new policy should
appear in the selector at the bottom of the list under the header <code>Custom</code>. Select it.</p><p>Under <code>Settings</code>, you can change <code>Price class</code> to &#x27;Use Only North America and Europe&#x27; to save some money.
For Alternate Domain Names, click &#x27;Add item&#x27;, then in the text box that appears, enter &#x27;resources.<code>&lt;domain&gt;</code>&#x27;, e.g.
<code>resources.etherealengine.org</code>, or &#x27;&lt;RELEASE_NAME&gt;.<code>&lt;domain&gt;</code>&#x27;, e.g. <code>dev.etherealengine.org</code>, depending on
whether you are serving the client files from client/API pods or the Storage Provider, respectively.
Under <code>Custom SSL Certificate</code>, click on the selector that says &#x27;Choose certificate&#x27;, then select the
&#x27;resources.<code>&lt;domain&gt;</code>&#x27;/&#x27;<code>&lt;RELEASE_NAME&gt;.&lt;domain&gt;</code>&#x27; certificate you made earlier. If you are serving the client
files from the Storage Provider, under <code>Default root object</code>, enter <code>client/index.html</code>; if you are serving
the client files from client/API pods, leave this blank.</p><p>Everything else can be left at the default values, click Create Distribution.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="legacy-cache-settings">Legacy cache settings<a href="#legacy-cache-settings" class="hash-link" aria-label="Direct link to Legacy cache settings" title="Direct link to Legacy cache settings">‚Äã</a></h4><p>If for some reason <code>Cache policy and origin request policy</code> is not available for you, and you have to use
<code>Legacy cache settings</code>, the under <code>Headers</code>, select &#x27;Include the following headers&#x27;. Under <code>Add header</code> that appears,
click on the selector titled &#x27;Select headers&#x27;, and in the menu that opens, check &#x27;Host&#x27;, &#x27;Origin&#x27;,
&#x27;Access-Control-Request-Method&#x27;, and &#x27;Access-Control-Request-Headers&#x27;, then click away.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-dns-records">Set up DNS records<a href="#set-up-dns-records" class="hash-link" aria-label="Direct link to Set up DNS records" title="Direct link to Set up DNS records">‚Äã</a></h2><p><strong>The Nginx Load Balancer must be fully set up and running before this step can be completed</strong></p><p>In the AWS web client, go to Route 53, then go into the Hosted Zone you made earlier.
Click on Create Record. If it starts you under Quick Create Record, click the link
&#x27;Switch to Wizard&#x27;; it&#x27;s not necessary, but the wizard is handy.</p><p>Under Routing Policy, leave it on Simple Routing and click Next. Then click Define Simple Record.</p><p>The first record should be for the top-level domain, e.g. <code>etherealengine.org</code>, so leave the Record Name
text field blank. Under Value/Route Traffic To, click on the dropdown and select
Alias to Network Load Balancer. Select the region that your cluster is in.
Where it says Choose Load Balancer, click the dropdown, and select the NLB that was created.
Leave the Record Type as &#x27;A - Route traffic to an IPv4 address and some AWS resources&#x27;, then click
Define Simple Record.</p><p>You can keep clicking Define Simple Record to make more records in one batch. When you&#x27;re
done, click Create Records.</p><p>You should make the following &#x27;A&#x27; records to the loadbalancer, substituting your domain for &#x27;etherealengine.org&#x27;:</p><ul><li>etherealengine.org</li><li>*.etherealengine.org</li><li>@.etherealengine.org</li><li>api-dev.etherealengine.org</li><li>api.etherealengine.org</li><li>dev.etherealengine.org -- Only if serving client files from client/API pods</li><li>instanceserver.etherealengine.org</li><li>instanceserver-dev.etherealengine.org</li></ul><p>You also need to make an &#x27;A&#x27; record pointing &#x27;resources.etherealengine.org&#x27; or &#x27;&lt;RELEASE_NAME&gt;.etheralengine.org&#x27; to the
CloudFront distribution you made earlier.
Instead of &#x27;Alias to Network Load Balancer&#x27;, select &#x27;Alias to Cloudfront distribution&#x27;, then click the text box that appears
that says &#x27;Choose distribution&#x27;. A selector should appear with the subdomain you&#x27;re routing as well as the Cloudfront
distribution&#x27;s domain name, which you should click on. Then click Define simple record.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-github-fork-of-ethereal-engine-repository">Create GitHub fork of Ethereal Engine repository.<a href="#create-github-fork-of-ethereal-engine-repository" class="hash-link" aria-label="Direct link to Create GitHub fork of Ethereal Engine repository." title="Direct link to Create GitHub fork of Ethereal Engine repository.">‚Äã</a></h2><p>The Ethereal Engine codebase is most easily deployed by forking it and configuring some Secrets so that the included GitHub
Actions can run the deployment for you. You can run all of the commands that the <code>&lt;dev/prod&gt;</code>-deploy action runs manually
if you so choose, and in that case, you don&#x27;t need to fork the GH repo.</p><p>Go to <a href="https://github.com/etherealengine/etherealengine" target="_blank" rel="noopener noreferrer">https://github.com/etherealengine/etherealengine</a>. In the upper right-hand corner, there&#x27;s a button &#x27;Fork&#x27;. Click that,
then click the account/organization you wish to fork it to. You should be taken to your fork in a short time.</p><p>You&#x27;ll need to set several Secrets (runtime variables) for GitHub Actions. By default GitHub Actions should be fully
enabled, but you can double-check by going to Settings-&gt;Actions. Allow All Actions should be selected under Actions
Permissions.</p><p>Next click on Secrets under Settings. There should be none by default. Click on New Repository Secret near the top of
this page to make a new one. You will need to make several Secrets with the following Names and Values:</p><ul><li>EKS_AWS_ACCESS_KEY -&gt; The public Key of the EKSUser IAM user</li><li>AWS_REGION -&gt; The region of your ECR repos and EKS cluster</li><li>EKS_AWS_SECRET -&gt; The secret key of the EKSUser IAM user</li><li>CLUSTER_NAME -&gt; The name of the EKS cluster</li><li>DEPLOYMENTS_ENABLED -&gt; Set to <code>true</code></li><li>DEV_REPO_NAME -&gt; The base name of the dev ECR repository, e.g. <code>etherealengine-dev</code> (all references to the builder and service repos will append <code>-builder</code>/<code>-&lt;service&gt;</code> to this value)</li><li>DOCKER_LABEL -&gt; This can be almost anything, but you can use <code>lagunalabs/etherealengine</code></li><li>ECR_URL -&gt; The root ECR_URL for your repos, i.e. everything before the <code>/etherealengine-dev-builder</code>, e.g. <code>11111111111.dkr.ecr.us-west-1.amazonaws.com</code> or <code>public.ecr.aws/a1b2c3d4</code></li><li>PRIVATE_ECR -&gt; Set this to <code>true</code> if your ECR repos are private, if they&#x27;re public you don&#x27;t need to set this at all</li></ul><p>If you go to the Actions Tab, you might see a few workflow runs with green checkmarks. If so, you&#x27;ll be re-running the
<code>dev-deploy</code> workflow shortly; its initial run just ran a check to see if it should do a deployment based on
<code>DEPLOYMENTS_ENABLED</code>, and since that wasn&#x27;t set to true, it didn&#x27;t do anything else. Now that that&#x27;s set to true,
re-running it will trigger a deployment.</p><p>If you&#x27;re asked to enable actions when going to the tab, and there are no runs listed after enabling actions, then you&#x27;ll have to
trigger the workflow by pushing new code to the dev branch.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="grant-eksuser-access-to-cluster">Grant EKSUser access to cluster<a href="#grant-eksuser-access-to-cluster" class="hash-link" aria-label="Direct link to Grant EKSUser access to cluster" title="Direct link to Grant EKSUser access to cluster">‚Äã</a></h2><p>By default, only the IAM user who set up an EKS cluster may access it.
In order to let other users access the cluster, you must apply an aws-auth configmap to the cluster
granting access to specific IAM users. A template of <a href="https://github.com/EtherealEngine/ethereal-engine-ops/blob/master/configs/aws-auth-template.yml" target="_blank" rel="noopener noreferrer">aws-auth-template.yml</a> file can be found in <a href="https://github.com/EtherealEngine/ethereal-engine-ops" target="_blank" rel="noopener noreferrer">ethereal-engine-ops</a> repo.</p><p>You&#x27;ll need to provide a few values for this file. To find <code>&lt;rolearn&gt;</code>, in AWS go to EKS-&gt;Clusters-&gt;
<code>&lt;your cluster&gt;</code>-&gt;Compute-&gt;Select a nodegroup.  In the details should be &#x27;Node IAM Role ARN&#x27;; copy this
and replace <code>&lt;rolearn&gt;</code> in the aws-auth file. <code>&lt;account_id&gt;</code> is the ID of your AWS account; in the upper
right corner of the AWS client should be <code>&lt;your_username&gt;@&lt;abcd-1234-efgh&gt;</code>. The 12-character string
after the @ is the account ID. Make sure to remove the <code>-</code>&#x27;s from the account ID when pasting it in.
<code>&lt;IAM_username&gt;</code> is the username of the IAM user you want to give access, e.g. <code>EKSUser</code>.</p><p>You can add multiple users by copying the <code>- groups:</code> section under <code>mapUsers</code>, e.g.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  mapUsers: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - groups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - system:masters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      userarn: arn:aws:iam::abcd1234efgh:user/EKSUser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      username: EKSUser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - groups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - system:masters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      userarn: arn:aws:iam::acbd1234efgh:user/FSmith</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      username: FSmith</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When the aws-auth config file is filled in, just run <code>kubectl apply -f path/to/aws-auth.yml</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-to-eks-using-helm">Deploy to EKS using Helm<a href="#deploy-to-eks-using-helm" class="hash-link" aria-label="Direct link to Deploy to EKS using Helm" title="Direct link to Deploy to EKS using Helm">‚Äã</a></h2><p>With all of the networking set up, you can finally deploy the codebase to EKS.
There&#x27;s a couple of steps to this, which will involve deploying things with most but not all of the needed
configuration values, and then letting the deployment process fill in the rest.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fill-in-helm-config-file-with-variables">Fill in Helm config file with variables<a href="#fill-in-helm-config-file-with-variables" class="hash-link" aria-label="Direct link to Fill in Helm config file with variables" title="Direct link to Fill in Helm config file with variables">‚Äã</a></h3><p>Template Helm config files for dev and prod deployments can be found in <a href="https://github.com/EtherealEngine/ethereal-engine-ops/blob/master/configs" target="_blank" rel="noopener noreferrer">configs</a> &lt;dev/prod&gt;.template.values.yaml.
Before filling them in, make a copy elsewhere, call that &#x27;&lt;dev/prod&gt;.values.yaml&#x27;, and edit that copy.
Both the builder and main deployments should use the same config file. When the builder seeds the database,
it needs a number of values that only need to be configured for the other services, so all of the values
need to be defined in one config file.</p><p>There are many fields to fill in, most marked with <code>&lt;&gt;</code>. Not all are necessary for all situations - if you&#x27;re not
using social login, for instance, you don&#x27;t need credentials for Github/Google/Facebook/etc.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-variables-of-note">Configuration variables of note<a href="#configuration-variables-of-note" class="hash-link" aria-label="Direct link to Configuration variables of note" title="Direct link to Configuration variables of note">‚Äã</a></h3><p>Here are some configuration variables that you&#x27;ll probably need to change based on your specific setup</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="apiinstanceservertaskserverextraenvauth_secret">&lt;api/instanceserver/taskserver&gt;.extraEnv.AUTH_SECRET<a href="#apiinstanceservertaskserverextraenvauth_secret" class="hash-link" aria-label="Direct link to &lt;api/instanceserver/taskserver&gt;.extraEnv.AUTH_SECRET" title="Direct link to &lt;api/instanceserver/taskserver&gt;.extraEnv.AUTH_SECRET">‚Äã</a></h4><p>This is a secret value that is used to sign the JWTs that authenticate users.
You can use any string for this value, and a randomly-generated one of sufficient length,
i.e. 32 or more characters, will suffice. If this is changed after some users have signed
in, their login credentials won&#x27;t work any more.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="apiclienttaskserveraffinitynodeaffinity">&lt;api/client/taskserver&gt;.affinity.nodeAffinity<a href="#apiclienttaskserveraffinitynodeaffinity" class="hash-link" aria-label="Direct link to &lt;api/client/taskserver&gt;.affinity.nodeAffinity" title="Direct link to &lt;api/client/taskserver&gt;.affinity.nodeAffinity">‚Äã</a></h4><p>Within the sections of the config for the api, client, instanceserver, etc., is a section that looks
something like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  affinity:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nodeAffinity:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      requiredDuringSchedulingIgnoredDuringExecution:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        nodeSelectorTerms:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - matchExpressions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              - key: eks.amazonaws.com/nodegroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                operator: In</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                values:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  - ng-1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The value, <code>ng-1</code> in this example, must be changed to match whatever the name of the nodegroup that
that service will be running on, e.g. if you create a nodegroup for the instanceservers called
<code>abcd-instanceservers-5</code>, then you&#x27;d use that value under <code>values:</code></p><p>If your EKS setup created a nodegroup for you, and you want to use that for the api, client, and
task servers, make sure to change the affinity value for them to whatever EKS named the
initial nodegroup.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="builderextraenvprivate_ecr">builder.extraEnv.PRIVATE_ECR<a href="#builderextraenvprivate_ecr" class="hash-link" aria-label="Direct link to builder.extraEnv.PRIVATE_ECR" title="Direct link to builder.extraEnv.PRIVATE_ECR">‚Äã</a></h4><p>If you&#x27;re using a private ECR repo, set this to &quot;true&quot; in the builder config file.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="everythingimagerepository">(everything).image.repository<a href="#everythingimagerepository" class="hash-link" aria-label="Direct link to (everything).image.repository" title="Direct link to (everything).image.repository">‚Äã</a></h4><p>You&#x27;ll need to replace every &lt;repository_name&gt; with the full ECR_URL of your non-builder repos, e.g. <code>abcd1234efgh.dkr.ecr.us-west-1.amazonaws.com/etherealengine-dev-api</code>.
Each service has to have the proper <code>-&lt;service&gt;</code> suffix on it, e.g. <code>-api</code>, <code>-client</code>, etc.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="github_client_idgithub_client_secret">GITHUB_CLIENT_ID/GITHUB_CLIENT_SECRET<a href="#github_client_idgithub_client_secret" class="hash-link" aria-label="Direct link to GITHUB_CLIENT_ID/GITHUB_CLIENT_SECRET" title="Direct link to GITHUB_CLIENT_ID/GITHUB_CLIENT_SECRET">‚Äã</a></h4><p>If you plan to backup Projects you create in the editor to GitHub, or install project from GitHub, it is necessary
to set up the OAuth app that will facilitate this before the initial installation.
See <a href="/etherealengine-docs/docs/host/devops_deployment/setup_github_oauth_for_projects">this document</a> for
more information, and enter the appropriate ID/secret in these variables.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-helm-install">Run Helm install<a href="#run-helm-install" class="hash-link" aria-label="Direct link to Run Helm install" title="Direct link to Run Helm install">‚Äã</a></h3><p>Run <code>helm install -f &lt;/path/to/&lt;RELEASE_NAME&gt;.values.yaml&gt; &lt;RELEASE_NAME&gt;-builder etherealengine/etherealengine-builder</code>
and then run <code>helm install -f &lt;/path/to/&lt;RELEASE_NAME&gt;.values.yaml&gt; &lt;RELEASE_NAME&gt; etherealengine/etherealengine</code></p><p>This will spin up the main and builder deployments using the Helm config file, &lt;dev/prod&gt;.values.yaml.
Neither will fully work yet, since there&#x27;s no valid image in the repos yet. The GitHub
Actions and builder processes will make those images and update the deployments with the tags of the images they&#x27;ve built
so that they can pull down and use those images.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kick-off-github-actions">Kick off GitHub Actions<a href="#kick-off-github-actions" class="hash-link" aria-label="Direct link to Kick off GitHub Actions" title="Direct link to Kick off GitHub Actions">‚Äã</a></h2><p>In GitHub, if you go to back to the Actions tab, you should see a <code>dev-deploy</code> action. Click on it, and you should see
a page showing its status, which should be all green checkmarks or indicators that things didn&#x27;t run. In the upper
right, click <code>Re-run all jobs</code>. This will start it again, and now that <code>DEPLOYMENTS_ENABLED</code> is set to true, it should
attempt to build and deploy the builder.</p><p>(If actions were disabled at first, you&#x27;ll have to merge additional code into the dev branch to get it to start the dev-deploy process)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-of-the-build-process">Overview of the build process<a href="#overview-of-the-build-process" class="hash-link" aria-label="Direct link to Overview of the build process" title="Direct link to Overview of the build process">‚Äã</a></h3><p>The full build and deployment process works like this:</p><ol><li>GitHub Actions builds just enough of the Ethereal Engine monorepo to fetch any installed Ethereal Engine projects.</li><li>GitHub Actions pushes this builder Docker image to the repo <code>etherealengine-&lt;release&gt;-builder</code> in ECR</li><li>GitHub Actions updates the builder deployment to point to the builder image it just created.</li><li>The builder deployment spins up the builder Docker image on its single node</li><li>The builder connects to the deployment&#x27;s database and checks if there is a table <code>user</code>. This is a proxy
for the database being seeded; if it does not exist, it seeds the database with the basic Ethereal Engine schema,
seeds the default project into the database and storage provider, and seeds various types.</li><li>The builder downloads any Ethereal Engine projects that the deployment has added.</li><li>The builder builds the Docker image for each service concurrently using these projects, building them into the client files as well as copying them so that the api and instanceservers have access to them.
If serving client files from the Storage Provider, the client files will be pushed to S3</li><li>The builder pushes these final Docker images to the repos <code>etherealengine-&lt;release&gt;-&lt;service&gt;</code> in ECR (not the client image if serving client files from the Storage Provider)</li><li>The builder caches all of the layers of each Docker file in S3 for faster build times on subsequent builds</li><li>The builder updates the main deployment to point to the final images it just created.</li><li>The main deployment spins up the final Docker images for the api, client (optional), instanceserver and taskserver services.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-elastic-search-and-kibana-using-helm-for-server-logs">Install Elastic Search and Kibana using Helm for Server Logs<a href="#install-elastic-search-and-kibana-using-helm-for-server-logs" class="hash-link" aria-label="Direct link to Install Elastic Search and Kibana using Helm for Server Logs" title="Direct link to Install Elastic Search and Kibana using Helm for Server Logs">‚Äã</a></h2><p>To install Elasticsearch, add the elastic repository in Helm: <code>helm repo add elastic https://helm.elastic.co</code></p><p>Now, use the curl command to download the values.yaml file containing configuration information:</p><p><code>curl -O https://raw.githubusercontent.com/elastic/helm-charts/master/elasticsearch/examples/minikube/values.yaml</code></p><p>Use the helm install command and the values.yaml file to install the Elasticsearch helm chart: </p><p><code>helm install elasticsearch elastic/elasticsearch -f ./values.yaml</code></p><p>The -f option allows specifying the yaml file with the template. If you wish to install Elasticsearch in a specific namespace, add the -n option followed by the name of the namespace: <code>helm install elasticsearch elastic/elasticsearch -n [namespace] -f ./values.yaml</code></p><p>Now check if the cluster members are up: <code>kubectl get pods --namespace=default -l app=elasticsearch-master -w</code></p><p>The other option is to use the helm test command to examine the cluster‚Äôs health: <code>helm test elasticsearch</code></p><p>To install Kibana on top of Elasticsearch : <code>helm install kibana elastic/kibana</code>
Check if all the pods are ready: <code>kubectl get pods</code></p><p>After you set up port-forwarding, access Elasticsearch, and the Kibana GUI by typing <code>http://localhost:5601 </code>in your browser</p><p>In order to connect logger with elasticsearch, update config file(values.yml) for Xr env <code>api.extraEnv.ELASTIC_HOST</code> for e.g. <code>http://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-an-existing-helm-deployment">Upgrading an existing Helm deployment<a href="#upgrading-an-existing-helm-deployment" class="hash-link" aria-label="Direct link to Upgrading an existing Helm deployment" title="Direct link to Upgrading an existing Helm deployment">‚Äã</a></h3><p>One of the features of Helm is being able to easily upgrade deployments with new values. The command to
do this is very similar to the install command:</p><p><code>helm upgrade --reuse-values -f &lt;/path/to/*.values.yaml&gt; --set api.image.tag=&lt;latest_github_commit_SHA&gt;,client.image.tag=&lt;latest_github_commit_SHA&gt;,instanceserver.image.tag=&lt;latest_github_commit_SHA&gt; &lt;RELEASE_NAME&gt; etherealengine/etherealengine</code></p><p><code>--reuse-values</code> says to carry over all configuration values from the previous deployment. This is most important
for tags, since they&#x27;re usually set inline with the <code>helm install/upgrade</code> command, not a Helm config.
Using <code>-f &lt;config_file&gt;</code> and <code>--set &lt;variables&gt;</code> after it will apply any changes on top of the
carryover values.</p><p>If you&#x27;re not deploying a new build of the codebase, you can skip the entirety of the <code>--set *.image.tag=&lt;SHA&gt;</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/EtherealEngine/etherealengine-docs/blob/master/docs/1_host/2_devops_deployment/2_AWS_setup.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/etherealengine-docs/docs/host/devops_deployment/minikube"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Ethereal Engine on Minikube</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/etherealengine-docs/docs/host/devops_deployment/installing_projects"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Installing Projects</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ways-of-serving-client-files-in-production" class="table-of-contents__link toc-highlight">Ways of serving client files in production</a><ul><li><a href="#serve-client-files-from-client-pods" class="table-of-contents__link toc-highlight">Serve client files from client pods</a></li><li><a href="#serve-client-files-from-api-pods" class="table-of-contents__link toc-highlight">Serve client files from API pods</a></li><li><a href="#serve-client-files-from-storage-provider-s3--cloudfront" class="table-of-contents__link toc-highlight">Serve client files from Storage Provider (S3 + Cloudfront)</a></li></ul></li><li><a href="#create-eks-cluster-with-four-nodegroups" class="table-of-contents__link toc-highlight">Create EKS cluster with four nodegroups</a></li><li><a href="#create-ecr-repositories-for-built-images" class="table-of-contents__link toc-highlight">Create ECR repositories for built images.</a></li><li><a href="#create-iam-roles-for-s3sessns-or-a-single-admin-role" class="table-of-contents__link toc-highlight">Create IAM Roles for S3/SES/SNS (or a single admin role)</a><ul><li><a href="#creating-an-iam-role" class="table-of-contents__link toc-highlight">Creating an IAM role</a></li><li><a href="#iam-roles-to-create" class="table-of-contents__link toc-highlight">IAM Roles to create</a></li><li><a href="#creating-new-credentials-for-an-iam-user" class="table-of-contents__link toc-highlight">Creating new credentials for an IAM user</a></li></ul></li><li><a href="#create-rds-box" class="table-of-contents__link toc-highlight">Create RDS box</a><ul><li><a href="#accessing-rds-box-from-an-external-machine" class="table-of-contents__link toc-highlight">Accessing RDS box from an external machine</a></li><li><a href="#create-rds-instance" class="table-of-contents__link toc-highlight">Create RDS instance</a></li></ul></li><li><a href="#edit-security-group-to-allow-instanceserver-traffic-into-vpc" class="table-of-contents__link toc-highlight">Edit security group to allow instanceserver traffic into VPC</a></li><li><a href="#create-route-53-hosted-zone-and-set-up-acm-certificates" class="table-of-contents__link toc-highlight">Create Route 53 Hosted Zone and set up ACM certificates</a><ul><li><a href="#purchase-and-register-domain-through-route53-optional" class="table-of-contents__link toc-highlight">Purchase and register domain through Route53 (optional)</a></li><li><a href="#create-route-53-hosted-zone" class="table-of-contents__link toc-highlight">Create Route 53 Hosted Zone</a></li><li><a href="#create-certificates-with-acm" class="table-of-contents__link toc-highlight">Create certificates with ACM</a></li></ul></li><li><a href="#install-agones-ingress-nginx-and-a-copy-of-redis-for-each-deployment" class="table-of-contents__link toc-highlight">Install Agones, ingress-nginx, and a copy of redis for each deployment</a><ul><li><a href="#install-agones" class="table-of-contents__link toc-highlight">Install Agones</a></li><li><a href="#install-redis-for-each-deployment" class="table-of-contents__link toc-highlight">Install redis for each deployment</a></li><li><a href="#install-ingress-nginx" class="table-of-contents__link toc-highlight">Install ingress-nginx</a></li></ul></li><li><a href="#set-up-simple-email-service-optional" class="table-of-contents__link toc-highlight">Set up Simple Email Service (optional)</a><ul><li><a href="#create-smtp-credentials" class="table-of-contents__link toc-highlight">Create SMTP credentials</a></li><li><a href="#move-ses-out-of-sandbox" class="table-of-contents__link toc-highlight">Move SES out of Sandbox</a></li></ul></li><li><a href="#set-up-simple-notification-service-optional" class="table-of-contents__link toc-highlight">Set up Simple Notification Service (optional)</a></li><li><a href="#set-up-s3-bucket-for-static-resources-and-cloudfront-distribution" class="table-of-contents__link toc-highlight">Set up S3 bucket for static resources and Cloudfront distribution</a><ul><li><a href="#create-s3-bucket" class="table-of-contents__link toc-highlight">Create S3 bucket</a></li><li><a href="#create-cloudfront-distribution" class="table-of-contents__link toc-highlight">Create Cloudfront distribution</a></li></ul></li><li><a href="#set-up-dns-records" class="table-of-contents__link toc-highlight">Set up DNS records</a></li><li><a href="#create-github-fork-of-ethereal-engine-repository" class="table-of-contents__link toc-highlight">Create GitHub fork of Ethereal Engine repository.</a></li><li><a href="#grant-eksuser-access-to-cluster" class="table-of-contents__link toc-highlight">Grant EKSUser access to cluster</a></li><li><a href="#deploy-to-eks-using-helm" class="table-of-contents__link toc-highlight">Deploy to EKS using Helm</a><ul><li><a href="#fill-in-helm-config-file-with-variables" class="table-of-contents__link toc-highlight">Fill in Helm config file with variables</a></li><li><a href="#configuration-variables-of-note" class="table-of-contents__link toc-highlight">Configuration variables of note</a></li><li><a href="#run-helm-install" class="table-of-contents__link toc-highlight">Run Helm install</a></li></ul></li><li><a href="#kick-off-github-actions" class="table-of-contents__link toc-highlight">Kick off GitHub Actions</a><ul><li><a href="#overview-of-the-build-process" class="table-of-contents__link toc-highlight">Overview of the build process</a></li></ul></li><li><a href="#install-elastic-search-and-kibana-using-helm-for-server-logs" class="table-of-contents__link toc-highlight">Install Elastic Search and Kibana using Helm for Server Logs</a><ul><li><a href="#upgrading-an-existing-helm-deployment" class="table-of-contents__link toc-highlight">Upgrading an existing Helm deployment</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/xr_engine" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/xrengine/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/xrf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/etherealengine/etherealengine" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.npmjs.com/search?q=%40etherealengine" target="_blank" rel="noopener noreferrer" class="footer__link-item">Npm<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.etherealengine.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ethereal Engine<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opencollective.com/etherealengine" target="_blank" rel="noopener noreferrer" class="footer__link-item">Open Collective<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2023 Ethereal Engine.</div></div></div></footer></div>
<script src="/etherealengine-docs/assets/js/runtime~main.6c67445e.js"></script>
<script src="/etherealengine-docs/assets/js/main.a156226e.js"></script>
</body>
</html>